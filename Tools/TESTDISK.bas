100 'CREATE DISK TEST115 CLEAR 1000120 '130 CLS140 PRINT "CREATE TEST DISK"150 PRINT "================"160 PRINT170 INPUT "DISK DRIVE (1-4)";DD180 IF DD<>1 AND DD<>2 AND DD<>3 AND DD<>4 GOTO 1010190 SREAD DD,20,1,A$,B$200 TT=ASC(MID$(B$,125,1))210 SS=ASC(MID$(B$,126,1))220 PRINT "TRACKS        : ";TT230 PRINT "TRACK SECTORS : ";SS231 SN=TT*SS232 PRINT "TOTAL SECTORS : ";SN240 F=FREE(DD)250 IF TT=40 AND SS=18 AND F<>175104 GOTO 1030260 IF TT=40 AND SS=36 AND F<>359424 GOTO 1030270 IF TT=80 AND SS=18 AND F<>359424 GOTO 1030280 IF TT=80 AND SS=36 AND F<>728064 GOTO 1030290 SP$=CHR$(129)+CHR$(130)+CHR$(136)+CHR$(132)291 Z$=""292 FOR I=1 TO 128293 Z$=Z$+CHR$(0)294 NEXT I300 FOR I=0 TO SN-1310 GOSUB 610315 GOSUB 710320 NEXT I500 GOTO 900600 'PROGRESS STATUS610 PRINT @257, USING "### %";I*100/SN615 PRINT @31,MID$(SP$,I-INT(I/4)*4+1,1);620 RETURN700 'WRITE SECTOR DATA710 S1$=Z$720 S2$=Z$730 MID$(S1$,1,1)=CHR$(INT(I/256))740 MID$(S1$,2,1)=CHR$(I-INT(I/256)*256)742 T=INT(I/SS)744 S=I-T*SS746 PRINT @480,USING "### ###";T,S+1;750 SWRITE DD,T,S+1,S1$,S2$760 RETURN900 PRINT901 PRINT "DONE!"910 END1000 'TERMINATE WITH ERROR1010 PRINT "ERROR: INVALID DISK DRIVE"1020 END1030 PRINT "ERROR: DISK IS NOT EMPTY"1040 END5000 PRINT "ERROR: CANNOT WRITE DISK SECTOR"5010 END